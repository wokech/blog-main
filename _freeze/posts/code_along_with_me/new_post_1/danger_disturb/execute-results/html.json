{
  "hash": "9d0ebbcadd9dd88c58f4deff83b5d098",
  "result": {
    "markdown": "---\ntitle: \"Code Along With Me (Episode 1)\"\nsubtitle: \"An assessment of the livestock numbers in the six counties declared to be 'disturbed and dangerous' in Kenya\"\nauthor: \"William Okech\"\ndate: \"2023-11-28\"\nimage: \"\"\ncategories: [RStudio, R, Tutorial, Blog]\ntoc: true\nformat: \n  html:\n    code-fold: show\n    code-overflow: wrap\n    warning: false\n---\n\n\n![*Image created using \"Bing Image Creator\" with the prompt keywords \"cows, sheep, indigenous cattle, running, dry savanna, river bed, traditional herdsman, nature photography, --ar 5:4 --style raw\"*](){fig-align=\"center\" width=\"80%\" fig-alt=\"Pastoral livestock running through a dry savanna followed by a traditional herder on horseback\"}\n\n# Introduction\n\nIn February 2023, the government of Kenya described six counties as \"disturbed\" and \"dangerous.\" This is because in the preceding six months, over 100 civilians and 16 police officers have lost their lives, as criminals engaged in banditry have terrorized the rural villages. One of the main causes of the conflict is livestock theft, therefore, my goal is to perform an exploratory data analysis of livestock numbers from the Kenya Population and Housing Census (2019) report.\n\nReferences\n\n1.  [Nation Media News Brief](https://nation.africa/kenya/news/killing-fields-kdf-police-versus-bandits-who-will-prevail--4122912)\n2.  [Citizen TV Summary](https://www.youtube.com/watch?v=nOqzHeeSS2A)\n\n# Section 1: Load all the required libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # a collection of packages used to model, transform, and visualize data\nlibrary(rKenyaCensus) # tidy datasets obtained from the Kenya Population and Housing Census results\nlibrary(patchwork) # combine separate ggplots into the same graphic\nlibrary(janitor) # initial data exploration and cleaning for a new data set\nlibrary(ggrepel)# repel overlapping text labels\nlibrary(ggthemes) # Extra Themes, Scales and Geoms for 'ggplot2'\nlibrary(scales) # tools to override the default breaks, labels, transformations and palettes\n# install.packages(\"treemapify\")\nlibrary(treemapify) # allows the creation of treemaps in ggplot2\n\nlibrary(sf) # simple features, a method to encode spatial vector data\n#install.packages(\"devtools\")\nlibrary(devtools) # helps to install packages not on CRAN\n#devtools::install_github(\"yutannihilation/ggsflabel\")\nlibrary(ggsflabel) # place labels on maps\n\nlibrary(knitr) # a tool for dynamic report generation in R\n#install.packages(\"kableExtra\")\nlibrary(kableExtra) # build common complex tables and manipulate table styles\n```\n:::\n\n\nNote: If you have package loading issues check the timeout with getOption('timeout') and use options(timeout = ) to increase package loading time.\n\n# Section 2: Create a map of the \"dangerous and disturbed\" counties\n\nThe rKenyaCensus package includes a built-in county boundaries dataset to facilitate mapping of the various indicators in the Census. The required shapefile for this analysis is KenyaCounties_SHP\n\n## a) Sample plot of the map of Kenya\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the shapefile\nkenya_counties_sf <- st_as_sf(KenyaCounties_SHP)\n\n# Plot the map of Kenya\np0 <- ggplot(kenya_counties_sf) + \n  geom_sf(fill = \"bisque2\", linewidth = 0.6, color = \"black\") + \n  theme_void()\np0\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## b) Highlight the dangerous and disturbed counties in Kenya\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First, remove the \"/\" from the county names\n\nkenya_counties_sf$County <- gsub(\"/\", \n                                 \" \", \n                                 kenya_counties_sf$County)\n\n# Select the six counties to highlight\nhighlight_counties <- c(\"TURKANA\", \"WEST POKOT\", \"ELGEYO MARAKWET\", \"BARINGO\", \"LAIKIPIA\", \"SAMBURU\")\n\n# Filter the counties dataset to only include the highlighted counties\nhighlighted <- kenya_counties_sf %>% filter(County %in% highlight_counties)\n\n# Plot the highlighted counties in the map\np1 <- ggplot() + \n  geom_sf(data = kenya_counties_sf, fill = \"bisque2\", linewidth = 0.6, color = \"black\") + \n  geom_sf(data  = highlighted, fill = \"chocolate4\", linewidth = 0.8, color = \"black\") +\n  theme_void()\np1\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## c) Plot only the required counties\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data = highlighted) +\n  geom_sf(aes(fill = County), linewidth = 1, show.legend = FALSE) +\n  geom_label_repel(aes(label = County, geometry = geometry), size = 3,\n                      stat = \"sf_coordinates\",\n                      force=10, # force of repulsion between overlapping text labels\n                      seed = 1,\n                      segment.size = 0.75,\n                      min.segment.length=0) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  labs(title = \"\",\n       caption = \"\") +\n  theme(plot.title = element_text(family = \"Helvetica\",size = 10, hjust = 0.5),\n        legend.title = element_blank(),\n        legend.position = \"none\",\n        plot.caption = element_text(family = \"Helvetica\",size = 12)) +\n  theme_void() \np2\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Notes: geom_label_repel() with geometry and stat defined can be used as an \n# alternative to geom_sf_label_repel()\n```\n:::\n\n\n## d) Combine the plots using patchwork to clearly highlight the counties of interest\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + \n  p2 + \n  plot_annotation(title = \"\",\n                  subtitle = \"\",\n                  caption = \"\",\n                  theme = theme(plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 25),\n                                plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n                                plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\")))\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# Section 3: Load the livestock data from the census report and generate the dataframes required for analysis.\n\n## a) View the data available in the data catalogue\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"DataCatalogue\")\n```\n:::\n\n\n## b) Load the livestock data\n\nHere, pastoral livestock are defined as sheep, goats, and indigenous cattle.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select the livestock data from the census report\ndf_livestock <- V4_T2.24\nlivestock <- df_livestock[2:393, ]\nlivestock <- livestock %>%\n  clean_names()\n\n# Remove the \"/\" from the county names in the dataset\nlivestock$county <- gsub(\"/\", \" \", livestock$county)\nlivestock$sub_county <- gsub(\"/\", \" \", livestock$sub_county)\n\n# Select the variables of interest from the dataset\n# These include the county, subcounty, land area, number of farming households, \n# sheep, goats, and indigenous cattle.\n\n# New variables listed below include:\n# pasto_livestock is the total number of sheep, goats, and indigenous cattle\n# ind_cattle_household is the number of indigenous cattle per household\n# goats_household is the number of goats per household\n# sheep_household is the number of sheep per household\n# pasto_livestock_household is the number of pastoral livestock per household\n\nlivestock_select <- livestock %>%\n  select(county, sub_county, admin_area, farming, sheep, goats, indigenous_cattle) %>%\n  mutate(pasto_livestock = sheep + goats + indigenous_cattle) %>% \n  mutate(ind_cattle_household = round(indigenous_cattle/farming)) %>%\n  mutate(goats_household = round(goats/farming)) %>%\n  mutate(sheep_household = round(sheep/farming)) %>%\n  mutate(pasto_livestock_household = round(pasto_livestock/farming))\n```\n:::\n\n\n## c) Filter data for the selected \"disturbed and dangerous\" counties\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select the data for the \"dangerous and disturbed\" counties\ndan_dist <- c(\"TURKANA\", \"WEST POKOT\", \"ELGEYO MARAKWET\", \"BARINGO\", \"LAIKIPIA\", \"SAMBURU\")\n\nlivestock_select_county <- livestock_select %>%\n  filter(admin_area == \"County\") %>%\n  filter(county %in% dan_dist)\n\n# Select subcounty data for the \"disturbed and dangerous\" counties\nlivestock_select_subcounty <- livestock_select %>%\n  filter(admin_area == \"SubCounty\") %>%\n  filter(county %in% dan_dist)\n\n# Create an area dataset for the \"dangerous and disturbed\" counties\ndf_land_area <- V1_T2.7\nland_area <- df_land_area[2:396,]\nland_area <- land_area %>%\n  clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a function to remove the \"/\", \" County\" from label, and change the label to UPPERCASE\n\nclean_county_names <- function(dataframe, column_name) {\n  dataframe[[column_name]] <- toupper(gsub(\"/\", \" \", gsub(\" County\", \"\", dataframe[[column_name]])))\n  return(dataframe)\n}\n\nland_area <- clean_county_names(land_area, 'county')\nland_area <- clean_county_names(land_area, 'sub_county')\n\n# The code above does the processes listed below:\n\n# land_area$county <- gsub(\"/\", \" \", land_area$county)\n# land_area$county <- gsub(\" County\", \"\", land_area$county)\n# land_area$county <- toupper(land_area$county)\n# land_area$sub_county <- toupper(land_area$sub_county)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtain the area data for \"disturbed and dangerous\" counties\nland_area_county <- land_area %>%\n  filter(admin_area == \"County\") %>%\n  select(county, land_area_in_sq_km) %>%\n  filter(county %in% dan_dist)\n\n# Get the subcounty area data for \"disturbed and dangerous\" counties\nland_area_subcounty <- land_area %>%\n  filter(admin_area == \"SubCounty\") %>%\n  select(county, sub_county, land_area_in_sq_km) %>%\n  filter(county %in% dan_dist) %>%\n  select(-county)\n```\n:::\n\n\n## d) Create the final datasets to be used for analysis. Use inner_join() and creating new variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a county dataset with area and livestock numbers for the disturbed and dangerous regions\n\nlivestock_area_county <- inner_join(livestock_select_county, land_area_county, by = \"county\")\n\n# New variables listed below include:\n# ind_cattle_area is the number of indigenous cattle per area_in_sq_km\n# goats_area is the number of goats per household per area_in_sq_km\n# sheep_area is the number of sheep per area_in_sq_km\n# pasto_livestock_area is the number of pastoral livestock per area_in_sq_km\n\nlivestock_area_county <- livestock_area_county %>%\n  mutate(ind_cattle_area = round(indigenous_cattle/land_area_in_sq_km),\n         sheep_area = round(sheep/land_area_in_sq_km),\n         goats_area = round(goats/land_area_in_sq_km),\n         pasto_livestock_area = round(pasto_livestock/land_area_in_sq_km))\n\n# Create a subcounty dataset with area and livestock numbers\n# for the disturbed and dangerous regions\n\nlivestock_area_subcounty <- inner_join(livestock_select_subcounty, land_area_subcounty, by = \"sub_county\")\n\n# New variables listed below include:\n# ind_cattle_area is the number of indigenous cattle per area_in_sq_km\n# goats_area is the number of goats per household per area_in_sq_km\n# sheep_area is the number of sheep per area_in_sq_km\n# pasto_livestock_area is the number of pastoral livestock per area_in_sq_km\n\nlivestock_area_subcounty <- livestock_area_subcounty %>%\n  mutate(ind_cattle_area = round(indigenous_cattle/land_area_in_sq_km),\n         sheep_area = round(sheep/land_area_in_sq_km),\n         goats_area = round(goats/land_area_in_sq_km),\n         pasto_livestock_area = round(pasto_livestock/land_area_in_sq_km))\n```\n:::\n\n\n# Section 4: Create a table with land area (sq. km) for the six counties\n\n**These six counties cover approximately one-fifth (1/5) of Kenya**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlivestock_area_county %>%\n  select(county, land_area_in_sq_km) %>%\n  mutate(county = str_to_title(county)) %>%\n  arrange(desc(land_area_in_sq_km)) %>%\n  adorn_totals(\"row\") %>%\n  rename(\"County\" = \"county\",\n         \"Land Area (sq. km)\" = \"land_area_in_sq_km\") %>%\n  kbl(align = \"c\") %>%\n  kable_classic() %>% \n  row_spec(row = 0, font_size = 21, color = \"white\", background = \"#000000\") %>%\n  row_spec(row = c(1:7), font_size = 15) %>%\n  row_spec(row = 6, extra_css = \"border-bottom: 1px solid;\") %>%\n  row_spec(row = 7, bold = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:center;color: white !important;background-color: #000000 !important;font-size: 21px;\"> County </th>\n   <th style=\"text-align:center;color: white !important;background-color: #000000 !important;font-size: 21px;\"> Land Area (sq. km) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;\"> Turkana </td>\n   <td style=\"text-align:center;font-size: 15px;\"> 68232.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;\"> Samburu </td>\n   <td style=\"text-align:center;font-size: 15px;\"> 21065.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;\"> Baringo </td>\n   <td style=\"text-align:center;font-size: 15px;\"> 10976.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;\"> Laikipia </td>\n   <td style=\"text-align:center;font-size: 15px;\"> 9532.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;\"> West Pokot </td>\n   <td style=\"text-align:center;font-size: 15px;\"> 9123.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;border-bottom: 1px solid;\"> Elgeyo Marakwet </td>\n   <td style=\"text-align:center;font-size: 15px;border-bottom: 1px solid;\"> 3032.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-size: 15px;font-weight: bold;\"> Total </td>\n   <td style=\"text-align:center;font-size: 15px;font-weight: bold;\"> 121961.8 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Section 5: Perform an exploratory data analysis to gain key insights about the data\n\n## a) Number of Farming Households at the County Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlac_1 <- livestock_area_county %>%\n  ggplot() + \n  geom_col(aes(x= reorder(county, farming), y = farming, fill = county)) +\n  geom_text(aes(x = county, y = 0, label = county),\n            hjust = 0, nudge_y = 0.25) +\n  geom_text(aes(x = county, y = farming, label = farming),\n            hjust = 1, nudge_y = 15000) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  coord_flip() + \n  labs(x = \"County\",\n       y = \"Number of Farming Households\",\n       title = \"\",\n       subtitle = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  scale_y_continuous(labels = comma) +\n  theme(axis.title.x =element_blank(), \n        axis.title.y =element_blank(),\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 20),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.title = element_blank(),\n        legend.position = \"none\",\n        plot.margin = unit(c(1, 1, 1, 1), \"cm\"))\n\n# Create a patchwork plot with the map and the bar graph\n\nlac_1 + p2\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## b) Number of Farming Households at the Subcounty Level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlivestock_area_subcounty %>%\n  ggplot() + \n  geom_col(aes(x= reorder(sub_county, farming), y = farming, fill = county), width = 0.95) +   geom_text(aes(x = sub_county, y = farming, label = farming),\n            hjust = 1, nudge_y = 2500, size = 4) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  coord_flip() +\n  guides(fill = guide_legend(nrow = 1)) +\n  labs(x = \"County\",\n       y = \"Number of Farming Households\",\n       fill = \"County\",\n       title = \"\",\n       subtitle = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  scale_y_continuous(labels = comma, expand = expansion(mult = c(0, 0.01))) +\n  theme(axis.title.x =element_blank(),\n        axis.title.y =element_blank(),\n        axis.text.x = element_text(size = 12),\n        axis.text.y = element_text(size = 12),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 20),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        plot.margin = unit(c(1, 1, 1, 1), \"cm\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.title = element_text(size = 10),\n        legend.text=element_text(size=8),\n        legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-14-1.png){width=864}\n:::\n:::\n\n\n## c) Number of pastoral livestock per county\n\n### Treemap\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(livestock_area_county, aes(area = pasto_livestock, fill = county, label = comma(pasto_livestock)\n                              )) +\n  geom_treemap() +\n  geom_treemap_text(colour = \"black\",\n                    place = \"centre\",\n                    size = 24) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  labs(x = \"\",\n       y = \"\",\n       title = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  theme(axis.title.x =element_text(size = 20),\n        axis.title.y =element_text(size = 20),\n        axis.text.x = element_text(size = 15),\n        axis.text.y = element_text(size = 15),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 28),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        legend.title = element_blank(),\n        legend.text=element_text(size=12),\n        legend.position = \"bottom\") \n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## d) Number of pastoral livestock per subcounty\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlivestock_area_subcounty %>%\n  ggplot() + \n  geom_col(aes(x= reorder(sub_county, pasto_livestock), y = pasto_livestock, fill = county), width = 0.95) + \n  geom_text(aes(x = sub_county, y = pasto_livestock, label = pasto_livestock),\n            hjust = 1, nudge_y = 125000) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  coord_flip() + \n  guides(fill = guide_legend(nrow = 1)) +\n  labs(x = \"Subcounty\",\n       y = \"Number of Pastoral Livestock\",\n       fill = \"County\",\n       title = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  scale_y_continuous(labels = comma, expand = expansion(mult = c(0, 0.01))) +\n  theme(axis.title.x =element_blank(),\n        axis.title.y =element_blank(),\n        axis.text.x = element_text(size = 12),\n        axis.text.y = element_text(size = 12),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 20),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        plot.margin = unit(c(1, 1, 1, 1), \"cm\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.title = element_text(size = 10),\n        legend.text=element_text(size=8),\n        legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-16-1.png){width=864}\n:::\n:::\n\n\n## e) Number of pastoral livestock per household at the county level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlac_2 <- livestock_area_county %>%\n  ggplot() + \n  geom_col(aes(x= reorder(county, pasto_livestock_household), y = pasto_livestock_household, fill = county)) + \ngeom_text(aes(x = county, y = pasto_livestock_household, label = pasto_livestock_household), hjust = 1, nudge_y = 5) +\n  scale_fill_brewer(palette = \"OrRd\") +\n  coord_flip() + \n  labs(x = \"County\",\n       y = \"Number of Pastoral Livestock per household\",\n       title = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  scale_y_continuous(labels = comma, expand = expansion(mult = c(0, 0.01))) +\n  theme(axis.title.x =element_blank(), \n        axis.title.y =element_blank(),\n        axis.text.x = element_text(size = 12),\n        axis.text.y = element_text(size = 12),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 20),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.title = element_blank(),\n        legend.position = \"none\",\n        plot.margin = unit(c(1, 1, 1, 1), \"cm\"))\n\n# Create a patchwork plot with the map and the bar graph\n\nlac_2 + p2\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## f) Number of pastoral livestock per household at the subcounty level\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlivestock_area_subcounty %>%\n  ggplot() + \n  geom_col(aes(x= reorder(sub_county, pasto_livestock_household), y = pasto_livestock_household, fill = county), width = 0.95) + \n  scale_fill_brewer(palette = \"OrRd\") +\n  geom_text(aes(x = sub_county, y = pasto_livestock_household, label = pasto_livestock_household),\n            hjust = 1, nudge_y = 5) +\n  coord_flip() + \n  guides(fill = guide_legend(nrow = 1)) +\n  labs(x = \"Subcounty\",\n       y = \"Number of Pastoral Livestock per household\",\n       fill = \"County\",\n       title = \"\",\n       caption = \"\") +\n  theme_minimal() +\n  scale_y_continuous(labels = comma, expand = expansion(mult = c(0, 0.01))) +\n  theme(axis.title.x =element_blank(),\n        axis.title.y =element_blank(),\n        axis.text.x = element_text(size = 12),\n        axis.text.y = element_text(size = 12),\n        plot.title = element_text(family=\"Helvetica\", face=\"bold\", size = 20),\n        plot.subtitle = element_text(family=\"Helvetica\", face=\"bold\", size = 15),\n        plot.caption = element_text(family = \"Helvetica\",size = 12, face = \"bold\"),\n        plot.margin = unit(c(1, 1, 1, 1), \"cm\"),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.title = element_text(size = 10),\n        legend.text=element_text(size=8),\n        legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](danger_disturb_files/figure-html/unnamed-chunk-18-1.png){width=864}\n:::\n:::\n\n# Section 5: Conclusion\n\nIn this post, I have assessed the pastoral livestock (indigenous cattle, sheep, and goats) populations in the Kenyan counties described as “disturbed and dangerous.” A major contributor to this classification is the banditry, livestock theft, and limited amounts of pasture and water available to livestock owners. To get a better sense of the number of households engaged in farming and the pastoral livestock populations in these counties, I performed an exploratory data analysis and visualized my results.\n\nKey findings from the study were that:\n1. Turkana and Samburu had some of the highest numbers of pastoral livestock, yet they had the fewest numbers of households engaged in farming. This meant that both these counties had the highest average livestock to farming household ratios in the region (Turkana: 55 per household and Samburu: 36 per household).\n2. The top three (3) subcounties with the highest average ratios of pastoral livestock to farming households were in Turkana. They included Turkana East (126), Kibish (96), and Turkana West (56). Surprisingly, counties such as Keiyo North (4), Koibatek (4), and Nyahururu (4) had very low ratios of pastoral livestock to farming household ratios despite having relatively high numbers of farming households. This may have resulted from the unsuitability of the land for grazing animals, small average land sizes per farming household, a switch to exotic dairy and beef livestock, or simply, a preference for crop, rather than livestock farming.\n\nIn the next analysis, I will assess the livestock numbers per area (square kilometers), the numbers of indigenous cattle, sheep, and goats in every county and subcounty, as well as the other animal husbandry and/or crop farming activities that take place in the region. The reader is encouraged to use this code and data package (rKenyaCensus) to come up with their own analyses to share with the world. \n\n",
    "supporting": [
      "danger_disturb_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}